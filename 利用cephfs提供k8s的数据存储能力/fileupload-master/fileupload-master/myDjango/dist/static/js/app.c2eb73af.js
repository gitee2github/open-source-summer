(function(e){function t(t){for(var i,r,n=t[0],o=t[1],c=t[2],d=0,p=[];d<n.length;d++)r=n[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);u&&u(t);while(p.length)p.shift()();return l.push.apply(l,c||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],i=!0,n=1;n<a.length;n++){var o=a[n];0!==s[o]&&(i=!1)}i&&(l.splice(t--,1),e=r(r.s=a[0]))}return e}var i={},s={app:0},l=[];function r(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=i,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(a,i,function(t){return e[t]}.bind(null,i));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],o=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var u=o;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"2c81":function(e,t,a){"use strict";a("7d5c")},"56d7":function(e,t,a){"use strict";a.r(t);var i={};a.r(i),a.d(i,"uploadFile",(function(){return Q})),a.d(i,"searchFileList",(function(){return V})),a.d(i,"deleteFile",(function(){return W}));var s=a("2b0e"),l=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[!0===e.route.meta.withMenu?t("div",{staticClass:"main"},[t("MyMenu"),t("div",{staticClass:"container"},[t("div",{staticClass:"container-header"},[t("MyhBreadcrumb")],1),t("div",{staticClass:"container-body"},[t("router-view")],1)])],1):t("div",{staticClass:"main"},[t("div",{staticClass:"non-menu-container"},[t("router-view")],1)])])},r=[],n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"menu"}},[t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"file","background-color":"rgb(99 124 150)","text-color":"rgb(202 202 202)","active-text-color":"#fff"},on:{select:e.changePath}},[t("el-menu-item",{attrs:{index:"file"}},[t("i",{staticClass:"el-icon-user-solid"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("文件上传")])])],1)],1)},o=[],c={name:"MyMenu",data(){return{}},mounted(){},computed:{},watch:{},methods:{changePath(e){this.$router.push({name:e})}}},u=c,d=a("2877"),p=Object(d["a"])(u,n,o,!1,null,null,null),h=p.exports,f=function(){var e=this,t=e._self._c;return t("el-breadcrumb",{attrs:{separator:"/"}},e._l(e.lists,(function(a){return t("el-breadcrumb-item",{key:a.path},[t("router-link",{attrs:{to:a.path}},[e._v(e._s(a.meta.title))])],1)})),1)},m=[],g={name:"MyhBreadcrumb",data(){return{lists:[]}},created(){this.lists=this.$route.matched},watch:{$route(e){this.lists=e.matched}}},b=g,v=Object(d["a"])(b,f,m,!1,null,null,null),C=v.exports,w={components:{MyMenu:h,MyhBreadcrumb:C},data(){return{}},computed:{route(){return console.log(this.$route),this.$route}}},k=w,y=(a("600d"),Object(d["a"])(k,l,r,!1,null,null,null)),_=y.exports,S=a("8c4f"),P=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"fileUpload"}},[t("div",{staticClass:"fileUpload-header"},[t("div",{staticClass:"search"},[t("span",{staticClass:"label"},[e._v("文件名")]),t("el-input",{staticClass:"filename",attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}),t("span",{staticClass:"label"},[e._v("上传时间")]),t("el-date-picker",{attrs:{type:"datetimerange",size:"small","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}})],1),t("div",{staticClass:"upload"},[t("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("上传文件")])],1)]),t("div",{staticClass:"table-info"},[t("span",[e._v("文件列表")]),t("div",{staticClass:"changePagenation"},[t("el-switch",{attrs:{"active-text":"分页展示","inactive-text":"不分页展示"},model:{value:e.isShowPagination,callback:function(t){e.isShowPagination=t},expression:"isShowPagination"}})],1)]),t("div",{staticClass:"fileUpload-table",class:e.isShowPagination?"with-pagination":""},[t("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:e.isShowPagination?e.currentTableData:e.filterTableData,stripe:"",height:"100%"}},[t("el-table-column",{attrs:{prop:"name",width:"500",label:"文件名"}}),t("el-table-column",{attrs:{prop:"create_time",label:"创建日期"}}),t("el-table-column",{attrs:{prop:"filetype",label:"文件类型"}}),t("el-table-column",{attrs:{prop:"size",label:"文件大小"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"operation"},[t("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.download(a.row)}}},[e._v(" 下载 ")]),t("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.deleteFile(a.row)}}},[e._v(" 删除 ")])],1)]}}])})],1)],1),e.isShowPagination?t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e(),t("UploadDialog",{ref:"uploadDialog",on:{close:e.dialogClose}})],1)},x=[],D=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"文件上传弹窗",visible:e.visible,width:"800px"},on:{"update:visible":function(t){e.visible=t},close:e.close}},[t("div",{staticClass:"upload-dialog-main"},[t("div",{staticClass:"upload-block"},[t("el-upload",{staticClass:"fileUploadBtn",attrs:{drag:"",action:"","on-change":e.handleChange,"auto-upload":!1,"show-file-list":!1,multiple:""}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),t("em",[e._v("点击上传")])])])],1),t("div",{staticClass:"upload-filelist"},[e._l(e.filelist,(function(a,i){return t("div",{key:a.uid,staticClass:"filelist-item"},[t("div",{staticClass:"filelist-item-right"},[t("div",{staticClass:"filelist-item-info"},[t("span",{staticClass:"filelist-item-name"},[e._v(e._s(a.name))]),t("div",{staticClass:"filelist-item-status"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.errorMsg,placement:"top-end"}},[t("i",{class:"el-icon-"+["s-promotion","loading","success","error"][a.processStatus]})])],1)]),t("div",{staticClass:"process"},[t("el-progress",{attrs:{"stroke-width":4,percentage:0===a.processStatus?0:1===a.processStatus?50:100,color:3===a.processStatus?"rgb(251 28 10)":"#1E6FFF","show-text":!1}})],1)]),t("div",{staticClass:"filelist-item-left",on:{click:function(t){return e.deleteFile(a,i)}}},[t("i",{staticClass:"el-icon-delete-solid"})])])})),0===e.filelist.length?t("div",{staticClass:"non-file"},[e._v(" 暂无待上传文件列表 ")]):e._e()],2)]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"danger"},on:{click:function(t){e.filelist=[]}}},[e._v("清空所有")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("开始上传")])],1)])},T=[],z={data(){return{visible:!1,filelist:[]}},methods:{show(){this.reset(),this.visible=!0},handleChange(e){"ready"===e.status&&(console.log(e),this.filelist.push({...e,processStatus:0,errorMsg:"等待上传"}))},submit(){console.log(this.filelist);const e=this.filelist.map(e=>{let t=new FormData;const{uid:a,raw:i,name:s,size:l}=e;t.append("uid",a),t.append("file",i),t.append("name",s),t.append("size",l);let r=this.filelist.find(e=>e.uid===a);return r.processStatus=1,r.errorMsg="正在上传",console.log("uid",t.get("uid")),this.$api.uploadFile(t).then(t=>{e.processStatus=2,e.errorMsg=t.error_msg||"上传成功"}).catch(t=>{e.processStatus=3,e.errorMsg=t.error_msg||"上传失败"})});Promise.all(e).then(()=>{this.$message.success("所有文件已上传成功")}).catch(()=>{this.$message.success("存在文件上传失败")})},deleteFile(e,t){0===e.processStatus?this.filelist.splice(t,1):this.$message.error("当前文件正在上传或以处理完毕，无法删除")},reset(){this.filelist=[]},close(){this.$emit("close")}}},M=z,F=(a("7bd5"),Object(d["a"])(M,D,T,!1,null,null,null)),O=F.exports,$={name:"FileUpload",components:{UploadDialog:O},data(){return{fileName:"",timeRange:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},tableData:[],pageSize:10,currentPage:1,isShowPagination:!0}},computed:{filterTableData(){return this.tableData.filter(e=>{const t=new Date(e.create_time).getTime();return(!this.fileName||e.name.indexOf(this.fileName)>-1)&&(0===this.timeRange.length||this.timeRange[0].getTime()<t&&t<this.timeRange[1].getTime())})},total(){return this.filterTableData.length},currentTableData(){return console.log(this.pageSize*this.currentPage),this.pageSize*this.currentPage>this.total+1?this.filterTableData.slice(this.pageSize*(this.currentPage-1)):this.filterTableData.slice(this.pageSize*(this.currentPage-1),this.pageSize*this.currentPage)}},methods:{handleSizeChange(e){this.pageSize=e},handleCurrentChange(e){this.currentPage=e},upload(){this.$refs.uploadDialog.show()},searchFileList(){this.$api.searchFileList().then(e=>{this.tableData=e.data.filelist})},download(e){let t=document.createElement("a");t.style.display="none",t.href=e.url,t.setAttribute("download",e.name),document.body.appendChild(t),t.click(),document.body.removeChild(t)},deleteFile(e){const t=e.id;this.$api.deleteFile({id:t}).then(e=>{0===e.error_code&&(this.$message.success("删除成功"),this.searchFileList())})},dialogClose(){this.searchFileList()}},mounted(){this.searchFileList()}},j=$,R=(a("2c81"),Object(d["a"])(j,P,x,!1,null,"5da7c6a2",null)),U=R.exports;s["default"].use(S["a"]);const L=[{path:"/",name:"file",component:U,meta:{withMenu:!0,title:"文件上传下载"}}],N=new S["a"]({routes:L});var B=N,E=a("5c96"),J=a.n(E),q=(a("0fae"),a("bc3a")),A=a.n(q);let H="";const X=A.a.create({timeout:1e4,baseURL:H});function G(e){let t="";switch(e.response.status){case 302:t="接口重定向了！";break;case 400:t="参数不正确！";break;case 401:t="您未登录，或者登录已经超时，请先登录！";break;case 403:t="您没有权限操作！";break;case 404:t="请求地址出错: "+e.response.config.url;break;case 408:t="请求超时！";break;case 409:t="系统已存在相同数据！";break;case 500:t="服务器内部错误！";break;case 501:t="服务未实现！";break;case 502:t="网关错误！";break;case 503:t="服务不可用！";break;case 504:t="服务暂时无法访问，请稍后再试！";break;case 505:t="HTTP 版本不受支持！";break;default:t="异常问题，请联系管理员！";break}return E["Message"].error(t),Promise.reject(e)}X.interceptors.request.use(e=>e,e=>{Promise.reject(e)}),X.interceptors.response.use(e=>{let t=e.data;return Promise.resolve(t)},e=>e&&e.response?G(e):Promise.reject("网络错误"));var I=X;function K(e){for(var t=document.cookie,a=t.split("; "),i=0;i<a.length;i++){var s=a[i].split("=");if(s[0]==e)return s[1]}return""}const Q=e=>I({url:"/api/uploadfile/",method:"post",headers:{"Content-Type":"multipart/form-data","X-CSRFToken":K("csrftoken")},data:e}),V=()=>I({url:"/api/searchfilelist/",method:"get"}),W=e=>I({url:"/api/deleteFile/",method:"get",params:e}),Y={...i};var Z=Y;s["default"].use(J.a),s["default"].config.productionTip=!1,s["default"].prototype.$message=J.a.Message,s["default"].prototype.$api=Z,new s["default"]({router:B,render:e=>e(_)}).$mount("#app")},"600d":function(e,t,a){"use strict";a("bd8e")},"7bd5":function(e,t,a){"use strict";a("df17")},"7d5c":function(e,t,a){},bd8e:function(e,t,a){},df17:function(e,t,a){}});
//# sourceMappingURL=app.c2eb73af.js.map