#define SECGEAR_ZUC_DEBUG_2
#include <stdio.h>
#include "zuc.h"

uint8 ck_test1[16] = {
    0x17, 0x3d, 0x14, 0xba, 
    0x50, 0x03, 0x73, 0x1d, 
    0x7a, 0x60, 0x04, 0x94, 
    0x70, 0xf0, 0x0a, 0x29,
};
uint32 count_test1 = 0x66035492;
uint8 bearer_test1 = 0xf;
uint8 dirc_test1 = 0x0;
uint32 len_test1 = 0xc1;
uint32 ibs_test1[] = {
    0x6cf65340, 0x735552ab, 0x0c9752fa, 0x6f9025fe, 0x0bd675d9, 
    0x005875b2, 0x00000000,
};

uint8 ck_test2[16] = {
    0xe5, 0xbd, 0x3e, 0xa0, 
    0xeb, 0x55, 0xad, 0xe8, 
    0x66, 0xc6, 0xac, 0x58, 
    0xbd, 0x54, 0x30, 0x2a,
};
uint32 count_test2 = 0x56823;
uint8 bearer_test2 = 0x18;
uint8 dirc_test2 = 0x1;
uint32 len_test2 = 0x320;
uint32 ibs_test2[] = {
    0x14a8ef69, 0x3d678507, 0xbbe7270a, 0x7f67ff50, 0x06c3525b, 
    0x9807e467, 0xc4e56000, 0xba338f5d, 0x42955903, 0x67518222, 
    0x46c80d3b, 0x38f07f4b, 0xe2d8ff58, 0x05f51322, 0x29bde93b, 
    0xbbdcaf38, 0x2bf1ee97, 0x3fbf9977, 0xbada8945, 0x847a2a6c, 
    0x9ad34a66, 0x7554e04d, 0x1f7fa2c3, 0x3241bd8f, 0x01ba220d, 
};

uint8 ck_test3[16] = {
    0xe1, 0x3f, 0xed, 0x21, 
    0xb4, 0x6e, 0x4e, 0x7e, 
    0xc3, 0x12, 0x53, 0xb2, 
    0xbb, 0x17, 0xb3, 0xe0, 
};
uint32 count_test3 = 0x2738cdaa;
uint8 bearer_test3 = 0x1a;
uint8 dirc_test3 = 0x0;
uint32 len_test3 = 0xfb3;
uint32 ibs_test3[] = {
    0x8d74e20d, 0x54894e06, 0xd3cb13cb, 0x3933065e, 0x8674be62, 0xadb1c72b, 0x3a646965, 0xab63cb7b, 0x7854dfdc, 0x27e84929, 
    0xf49c64b8, 0x72a490b1, 0x3f957b64, 0x827e71f4, 0x1fbd4269, 0xa42c97f8, 0x24537027, 0xf86e9f4a, 0xd82d1df4, 0x51690fdd, 
    0x98b6d03f, 0x3a0ebe3a, 0x312d6b84, 0x0ba5a182, 0x0b2a2c97, 0x09c090d2, 0x45ed267c, 0xf845ae41, 0xfa975d33, 0x33ac3009, 
    0xfd40eba9, 0xeb5b8857, 0x14b768b6, 0x97138baf, 0x21380eca, 0x49f644d4, 0x8689e421, 0x5760b906, 0x739f0d2b, 0x3f091133, 
    0xca15d981, 0xcbe401ba, 0xf72d05ac, 0xe05cccb2, 0xd297f4ef, 0x6a5f58d9, 0x1246cfa7, 0x7215b892, 0xab441d52, 0x78452795, 
    0xccb7f5d7, 0x9057a1c4, 0xf77f80d4, 0x6db2033c, 0xb79bedf8, 0xe60551ce, 0x10c667f6, 0x2a97abaf, 0xabbcd677, 0x2018df96, 
    0xa282ea73, 0x7ce2cb33, 0x1211f60d, 0x5354ce78, 0xf9918d9c, 0x206ca042, 0xc9b62387, 0xdd709604, 0xa50af16d, 0x8d35a890, 
    0x6be484cf, 0x2e74a928, 0x99403643, 0x53249b27, 0xb4c9ae29, 0xeddfc7da, 0x6418791a, 0x4e7baa06, 0x60fa6451, 0x1f2d685c, 
    0xc3a5ff70, 0xe0d2b742, 0x92e3b8a0, 0xcd6b04b1, 0xc790b8ea, 0xd2703708, 0x540dea2f, 0xc09c3da7, 0x70f65449, 0xe84d817a, 
    0x4f551055, 0xe19ab850, 0x18a0028b, 0x71a144d9, 0x6791e9a3, 0x57793350, 0x4eee0060, 0x340c69d2, 0x74e1bf9d, 0x805dcbcc, 
    0x1a6faa97, 0x6800b6ff, 0x2b671dc4, 0x63652fa8, 0xa33ee509, 0x74c1c21b, 0xe01eabb2, 0x16743026, 0x9d72ee51, 0x1c9dde30, 
    0x797c9a25, 0xd86ce74f, 0x5b961be5, 0xfdfb6807, 0x814039e7, 0x137636bd, 0x1d7fa9e0, 0x9efd2007, 0x505906a5, 0xac45dfde, 
    0xed7757bb, 0xee745749, 0xc2963335, 0x0bee0ea6, 0xf409df45, 0x80160000, 
};

void zuc_test2(uint32 count, uint8 bearer, uint8 direction, uint8 ck[], 
               uint32 length, uint32 ibs[], uint32 obs[]) {
    zuc_confidentiality(count, bearer, direction, ck, length, ibs, obs); 
}



int main(){
    uint32 obs_test[130];
    printf("Test 1: \n");
    zuc_test2(count_test1, bearer_test1, dirc_test1, ck_test1, len_test1, ibs_test1, obs_test);
    printf("Test 2: \n");
    zuc_test2(count_test2, bearer_test2, dirc_test2, ck_test2, len_test2, ibs_test2, obs_test);
    printf("Test 3: \n");
    zuc_test2(count_test3, bearer_test3, dirc_test3, ck_test3, len_test3, ibs_test3, obs_test);
    return 0;
}