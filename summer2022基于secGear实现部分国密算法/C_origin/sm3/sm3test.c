#include "sm3.h"
#include <string.h>
#include <stdio.h>

uint8 p1[] = {0x61, 0x62, 0x63};
uint8 p2[] = {
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
    0x61, 0x62, 0x63, 0x64, 
};

void sm3test(uint8 *md, size_t len, uint8 *res) {
    SM3_CTX c;
    sm3_init(&c);
    sm3_update(&c, md, len);
    sm3_final(res, &c);
}

int main(){
    uint8 res[32]={};
    printf("Test 1: \n");
    // printf("len = %lu\n",sizeof (p1));
    sm3test(p1, 3, res);
    for(int i=0;i<32;i++) {
        printf("%02X",res[i]);
    }
    putchar('\n');
    printf("Test 2: \n");
    sm3test(p2, 64, res);
    for(int i=0;i<32;i++) {
        printf("%02x",res[i]);
    }
    putchar('\n');
    return 0;
}

// Test 1: 
// 66C7F0F462EEEDD9D1F2D46BDC10E4E24167C4875CF2F7A2297DA02B8F4BA8E0
// Test 2: 
// debe9ff92275b8a138604889c18e5a4d6fdb70e5387e5765293dcba39c0c5732
